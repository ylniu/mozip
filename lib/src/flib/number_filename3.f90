subroutine number_filename3(fname,pre,a,n,m)
	implicit none
	!---------------------------------------------------------------------------
	character(*)   :: fname, pre
	real(8)        :: a(3)
	integer        :: n, m
	character(  1) :: sgn(3)
	character(200) :: str, fmt
	!---------------------------------------------------------------------------
	integer        :: k, j
	!---------------------------------------------------------------------------
	sgn="+"
	if (a(1) < 0) sgn(1)="-"
	if (a(2) < 0) sgn(2)="-"
	if (a(3) < 0) sgn(3)="-"
	write(fmt,'("f",i0,".",i0)') n,m
	fmt='("'//trim(adjustl(pre))//'_x'//sgn(1)//'",'//trim(fmt)//',"_y'//sgn(2)//'"'//trim(fmt)//',"_z'//sgn(3)//'"'//trim(fmt)//')'
	!---------------------------------------------------------------------------
	write(str,fmt) abs(a)
	!---------------------------------------------------------------------------
	k=len(trim(str))
	!---------------------------------------------------------------------------
	do j=1,k
		if(str(j:j)==" ") then
			str(j:j)="0"
		end if
	end do
	fname=trim(str)
	!---------------------------------------------------------------------------
	return
end subroutine
