subroutine qm_file_nbasis(fname, na, nb, norb, info)
	implicit none
	!----------------------------------------------------------------------------
	! Input  variable
	!
	character(*), intent( in) :: fname
	!----------------------------------------------------------------------------
	! Output variables
	!
	integer     , intent(out) :: info
	integer     , intent(out) :: na, nb, norb
	!----------------------------------------------------------------------------
	! Local  variables
	!
	integer                   :: fid
	character(200)            :: line, file_type, version, tmp
	logical                   :: scanok
	logical     , external    :: search_word_free
	!----------------------------------------------------------------------------
	na = 0
	nb = 0
	call qm_file_type(fname, file_type, version, info)
	!----------------------------------------------------------------------------
	call get_free_fid(fid)
	!----------------------------------------------------------------------------
	info = -1
	!----------------------------------------------------------------------------
	! Check if Turbomole freq file
	!----------------------------------------------------------------------------
	open(fid, file=fname, status="old")
	select case(trim(file_type))
		!-------------------------------------------------------------------------
		case ("CHEMSHELL")
			!----------------------------------------------------------------------
			! CHEMSHELL
			!----------------------------------------------------------------------
		case ("GAUSSIAN LOG")
			!----------------------------------------------------------------------
			! GAUSSIAN LOG
			!----------------------------------------------------------------------
			if(search_word_free(fid,"alpha electrons",line)) then
				read(line,*) na, tmp, tmp, nb
				scanok=search_word_free(fid,"NBsUs",line)
				read(line,*) tmp, norb
				close(fid)
				return
			end if
			!----------------------------------------------------------------------
		case ("GAUSSIAN FCHK")
			!----------------------------------------------------------------------
			! GAUSSIAN FCHK
			!----------------------------------------------------------------------
			!----------------------------------------------------------------------
		case ("MOLPRO")
			!----------------------------------------------------------------------
			! MOLPRO
			!----------------------------------------------------------------------
			!----------------------------------------------------------------------
		case ("TURBOMOLE")
			!----------------------------------------------------------------------
			! TURBOMOLE
			!----------------------------------------------------------------------
			!scanok=search_word_del_space(fid,"type atoms prim cont basis",line)
			!----------------------------------------------------------------------
		case ("NUMFORCE")
			!----------------------------------------------------------------------
			! NUMFORCE
			!----------------------------------------------------------------------
			!----------------------------------------------------------------------
		case ("NWCHEM")
			!----------------------------------------------------------------------
			! NWCHEM
			!----------------------------------------------------------------------
			!----------------------------------------------------------------------
		case ("CIF")
			!----------------------------------------------------------------------
			! CIF
			!----------------------------------------------------------------------
		case ("PWOUT")
			!----------------------------------------------------------------------
			! PWOUT
			!----------------------------------------------------------------------
		case default
	end select
	close(fid)
	!----------------------------------------------------------------------------
	return
end subroutine
