subroutine check_sym_matrix(n, a)
	use kinds, only: DP
	implicit none
	!--------------------------------------------------------------------
	integer , intent(in   ) :: n
	real(DP), intent(inout) :: a(n,n)
	!--------------------------------------------------------------------
	integer                 :: m, i, j
	real(DP)                :: dx, tol
	!--------------------------------------------------------------------
	tol = 7.D-6
	dx  = 0.D0
	m   = n*(n-1)/2
	!--------------------------------------------------------------------
	do i=2, n
		do j=1, i-1
			if (abs(a(i,j) - a(j,i))>tol) write(*,'(2i4, 2e18.8, 4x, e18.8)') i,j,a(i,j), a(j,i), abs(a(i,j)-a(j,i))
			dx = dx + (a(i,j) - a(j,i))**2
		end do
	end do
	!--------------------------------------------------------------------
	! dx = dx / m
	dx = sqrt(dx)
	write(*,*) dx
	!--------------------------------------------------------------------
	return
end subroutine
