subroutine com(n, mass, x, info)
	use kinds, only: DP
	implicit none
	!----------------------------------------------------------------------------
	integer , intent(in   ) :: n
	real(DP), intent(in   ) :: mass(n)
	integer , intent(  out) :: info
	real(DP), intent(inout) :: x(3, n)
	!----------------------------------------------------------------------------
	integer                 :: i
	real(DP)                :: mt
	real(DP)                :: xc(3)
	!----------------------------------------------------------------------------
	info = 0
	if (n<0) then
		info = -1
		return
	end if
	!----------------------------------------------------------------------------
	mt = 0.0_DP
	xc = 0.0_DP
	!----------------------------------------------------------------------------
	do i=1, n
		mt = mt + mass(i)
		xc = xc + mass(i) * x(:,i)
	end do
	!----------------------------------------------------------------------------
	xc = xc / mt
	!----------------------------------------------------------------------------
	do i=1, n
		x(:,i) = x(:,i) - xc
	end do
	!----------------------------------------------------------------------------
	return
end
