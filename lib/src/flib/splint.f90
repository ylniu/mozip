	subroutine splint(xa,ya,y2a,n,x,y)
	!--------------------------------------------------------------------
	use kinds, only:DP
	implicit none
	!--------------------------------------------------------------------
	integer  :: n
	real(DP) :: x,y,xa(n),y2a(n),ya(n)
	integer  :: k,khi,klo
	real(DP) :: a,b,h
	!--------------------------------------------------------------------
	klo=1
	khi=n
	!--------------------------------------------------------------------
	if (x<xa(1) .or. x>xa(n)) then
		y=0.0_DP
		return
	end if
	!--------------------------------------------------------------------
	do while(khi-klo > 1)
		k = ( khi + klo ) / 2
		if(x<xa(k))then
			khi = k
		else
			klo = k
		end if
	end do
	!--------------------------------------------------------------------
	h=xa(khi)-xa(klo)
	if (h==0.0_DP) then
		stop "bad xa input in splint"
	end if
	a = (xa(khi)-x) / h
	b = (x-xa(klo)) / h
	y = a * ya(klo) + b * ya(khi) &
		+ ((a**3-a)*y2a(klo)+(b**3-b)*y2a(khi)) * (h**2) / 6.0_DP
	!--------------------------------------------------------------------
	return
	!--------------------------------------------------------------------
	end
