subroutine getCoulombFF(ix,iy,iz)
	use kinds     , only: DP
	use module_afm, only: FF, tip, bas
	implicit none
	!--------------------------------------------------------------------
	! Input  variables
	!
	integer, intent(in) :: ix, iy, iz
	!--------------------------------------------------------------------
	! Local  variables
	!
	integer             :: itip, ibas
	real(DP)            :: q_tip, q_bas
	real(DP)            :: x_tip(3), x_bas(3), v(3), r, f(3)
	!--------------------------------------------------------------------
	x_tip = FF%x(:,ix,iy,iz)
	!--------------------------------------------------------------------
	do itip=1, tip%n
		!-----------------------------------------------------------------
		q_tip = tip%charge(itip)
		f     = 0.0_DP
		!-----------------------------------------------------------------
		do ibas=1, bas%n
			!--------------------------------------------------------------
			x_bas = bas%x     (:,ibas)
			q_bas = bas%charge(  ibas)
			!--------------------------------------------------------------
			v = x_tip - x_bas
			r = sqrt(dot_product(v,v))
			v = v / r
			!--------------------------------------------------------------
			f = f + q_tip * q_bas / r**2 * v
		end do
		!-----------------------------------------------------------------
		FF%C(:, ix, iy, iz, itip) = f
		!-----------------------------------------------------------------
	end do
	!--------------------------------------------------------------------
end subroutine
